---
import Layout from "../layouts/Layout.astro";
import Nav from "../components/Nav.astro";
import Hero from "../components/Hero.astro";
import About from "../components/About.astro";
import HowWeBuy from "../components/HowWeBuy.astro";
import Criteria from "../components/Criteria.astro";
import Promise from "../components/Promise.astro";
import CtaSection from "../components/CtaSection.astro";
import Footer from "../components/Footer.astro";

let homeData: Record<string, unknown> | null = null;
try {
	const { client } = await import("../../tina/__generated__/client.js");
	const queries = client?.queries as Record<string, ((args: { relativePath: string }) => Promise<{ data?: { page?: Record<string, unknown> } }>) | undefined>;
	if (queries?.page) {
		const result = await queries.page({ relativePath: "home/home.md" });
		homeData = result?.data?.page ?? null;
	}
} catch (_) {
	// Tina client not ready or page collection not generated yet; components use defaults
}

const data = homeData as Record<string, Record<string, unknown>> | null;
---

<Layout>
	<Nav />
	<Hero data={data?.hero} />
	<About data={data?.about} />
	<HowWeBuy data={data?.how} />
	<Criteria data={data?.criteria} />
	<Promise data={data?.promise} />
	<CtaSection data={data?.cta} />
	<Footer />
</Layout>
